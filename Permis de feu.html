<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Jeu de Classement - Permis de Feu</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #ffffff;
      text-align: center;
      padding: 20px;
    }
    #logo {
      width: 200px;
      margin-bottom: 10px;
    }
    #startButton {
      font-size: 20px;
      padding: 15px 30px;
      margin-top: 20px;
      cursor: pointer;
      background-color: #3498db;
      color: white;
      border: none;
      border-radius: 25px;
      transition: background-color 0.3s;
    }
    #startButton:hover {
      background-color: #2980b9;
    }
    #timer {
      font-size: 24px;
      margin: 10px 0;
      color: #e74c3c;
    }
    #progression {
      margin: 20px 0;
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 5px;
    }
    .circle {
      width: 30px;
      height: 30px;
      background-color: #ccc;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 14px;
    }
    .active {
      background-color: #2ecc71;
      color: white;
    }
    #zoneJeu {
      display: none;
      flex-direction: column;
      align-items: center;
    }
    .card {
      width: 450px;
      height: 200px;
      margin: 20px;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
      background: #ffffff;
      font-size: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      color: #2c3e50;
    }
    .zone-classement {
      display: flex;
      justify-content: center;
      margin-top: 30px;
      gap: 30px;
    }
    .box {
      width: 250px;
      height: 150px;
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 10px;
      font-weight: bold;
      cursor: pointer;
      color: white;
    }
    .employeur {
      background-color: #3498db;
    }
    .responsable {
      background-color: #2ecc71;
    }
    .operateur {
      background-color: #e67e22;
    }
    h1 {
      color: #2c3e50;
    }
    .hidden {
      display: none;
    }
    #resultat {
      margin-top: 30px;
      font-size: 40px;
      font-weight: bold;
    }
    #correction, #vosReponses {
      margin-top: 30px;
      font-size: 18px;
      color: #34495e;
      text-align: left;
      max-width: 800px;
      margin-left: auto;
      margin-right: auto;
    }
    .correct {
      background-color: #d4edda;
      padding: 10px;
      border-radius: 8px;
      margin-bottom: 5px;
    }
    .incorrect {
      background-color: #f8d7da;
      padding: 10px;
      border-radius: 8px;
      margin-bottom: 5px;
    }
    button {
      margin: 10px;
      padding: 15px 30px;
      font-size: 18px;
      cursor: pointer;
      background-color: #3498db;
      color: white;
      border: none;
      border-radius: 25px;
      transition: background-color 0.3s;
    }
    button:hover {
      background-color: #2980b9;
    }
  </style>
</head>

<body>

<img id="logo" src="logo_prevone.png" alt="Prev'One Formation">
<h1>Jeu de Classement - Missions Permis de Feu</h1>

<button id="startButton" onclick="demarrerJeu()">Démarrer le jeu</button>

<div id="zoneJeu">
  <div id="timer">Temps restant : 20s</div>
  <div id="progression"></div>
  <div id="carte" class="card"></div>

  <div class="zone-classement">
    <div class="box employeur" onclick="classer('Employeur')">Donneur d'ordre</div>
    <div class="box responsable" onclick="classer('Responsable')">Responsable Sécurité</div>
    <div class="box operateur" onclick="classer('Operateur')">Opérateur</div>
  </div>
</div>

<div id="resultat" class="hidden"></div>

<div id="actions" class="hidden">
  <button onclick="rejouer()">Rejouer</button>
  <button onclick="afficherCorrection()">Voir la correction</button>
  <button onclick="afficherVosReponses()">Voir vos réponses</button>
</div>

<div id="correction" class="hidden"></div>
<div id="vosReponses" class="hidden"></div>

<script>
const missions = [
  {role: "Employeur", text: "Rédiger et valider le permis de feu avant toute intervention"},
  {role: "Employeur", text: "Définir les mesures générales de prévention et les communiquer"},
  {role: "Employeur", text: "Désigner un responsable pour la coordination des opérations"},
  {role: "Employeur", text: "S'assurer que le personnel extérieur est informé des consignes du site"},
  {role: "Employeur", text: "Mettre à disposition les moyens de secours (extincteurs, alarmes)"},
  {role: "Employeur", text: "Organiser la levée des protections temporaires après travaux"},
  {role: "Employeur", text: "Archiver le permis de feu après intervention"},
  {role: "Employeur", text: "Analyser les incidents et mettre à jour les procédures"},
  {role: "Employeur", text: "Vérifier la conformité des travaux terminés"},
  {role: "Employeur", text: "Autoriser la reprise d'activité après sécurisation"},
  {role: "Responsable", text: "Analyser précisément les risques liés à l'opération"},
  {role: "Responsable", text: "Contrôler l'absence de matières inflammables sur le site"},
  {role: "Responsable", text: "S'assurer que la ventilation est suffisante en zone fermée"},
  {role: "Responsable", text: "Vérifier l'état des moyens d'extinction avant démarrage"},
  {role: "Responsable", text: "Valider le port effectif des EPI spécifiques au feu"},
  {role: "Responsable", text: "Superviser la mise en place des protections collectives"},
  {role: "Responsable", text: "Interrompre les travaux en cas de non-conformité constatée"},
  {role: "Responsable", text: "Surveiller en continu la zone pendant les travaux"},
  {role: "Responsable", text: "Assurer la surveillance pendant 2h après l'arrêt des travaux"},
  {role: "Responsable", text: "Réaliser un contrôle final post-intervention"},
  {role: "Operateur", text: "Lire et comprendre les consignes du permis de feu"},
  {role: "Operateur", text: "Contrôler le bon état de son matériel avant démarrage"},
  {role: "Operateur", text: "Vérifier la présence d'extincteurs à proximité immédiate"},
  {role: "Operateur", text: "Porter l'ensemble des EPI requis pour les travaux à chaud"},
  {role: "Operateur", text: "Ne jamais quitter le chantier sans avertir la surveillance"},
  {role: "Operateur", text: "Respecter strictement la zone définie dans le permis de feu"},
  {role: "Operateur", text: "Arrêter immédiatement en cas d'incident ou d'alarme"},
  {role: "Operateur", text: "Refroidir les surfaces métalliques après soudage ou découpe"},
  {role: "Operateur", text: "Signaler toute anomalie constatée pendant l'intervention"},
  {role: "Operateur", text: "Valider la fin de l'intervention auprès du responsable"}
];

let index = 0;
let correct = 0;
let timeLeft = 20;
let timerInterval;
let userAnswers = [];

missions.sort(() => Math.random() - 0.5);

function demarrerJeu() {
  document.getElementById('startButton').style.display = 'none';
  document.getElementById('zoneJeu').style.display = 'flex';
  afficherCarte();
}

function startTimer() {
  clearInterval(timerInterval);
  timeLeft = 20;
  document.getElementById('timer').innerText = `Temps restant : ${timeLeft}s`;
  timerInterval = setInterval(() => {
    timeLeft--;
    document.getElementById('timer').innerText = `Temps restant : ${timeLeft}s`;
    if (timeLeft <= 0) {
      userAnswers.push("Non répondu");
      index++;
      afficherCarte();
    }
  }, 1000);
}

function afficherCarte() {
  updateProgression();
  if (index < missions.length) {
    const mission = missions[index];
    document.getElementById('carte').innerHTML = mission.text;
    startTimer();
  } else {
    clearInterval(timerInterval);
    afficherResultat();
    document.getElementById('actions').classList.remove('hidden');
  }
}

function classer(choix) {
  if (missions[index].role === choix) correct++;
  userAnswers.push(choix);
  index++;
  afficherCarte();
}

function afficherResultat() {
  document.getElementById('zoneJeu').style.display = 'none';
  const pourcentage = Math.round((correct / missions.length) * 100);
  const scoreColor = pourcentage >= 80 ? 'green' : (pourcentage >= 50 ? 'orange' : 'red');
  document.getElementById('resultat').classList.remove('hidden');
  document.getElementById('resultat').style.color = scoreColor;
  document.getElementById('resultat').innerHTML = `Votre score : ${pourcentage}%`;
}

function updateProgression() {
  const progDiv = document.getElementById('progression');
  progDiv.innerHTML = '';
  for (let i = 0; i < missions.length; i++) {
    const circle = document.createElement('div');
    circle.className = 'circle';
    if (i === index) circle.classList.add('active');
    circle.innerText = i + 1;
    progDiv.appendChild(circle);
  }
}

function rejouer() {
  location.reload();
}

function afficherCorrection() {
  document.getElementById('correction').classList.remove('hidden');
  let texte = '<h2>Correction</h2><ul>';
  missions.forEach((m, i) => {
    texte += `<li>Question ${i+1} - <strong>${m.role}</strong> : ${m.text}</li>`;
  });
  texte += '</ul>';
  document.getElementById('correction').innerHTML = texte;
}

function afficherVosReponses() {
  document.getElementById('vosReponses').classList.remove('hidden');
  let texte = '<h2>Vos Réponses</h2>';
  missions.forEach((m, i) => {
    const classe = (userAnswers[i] === m.role) ? 'correct' : 'incorrect';
    texte += `<div class=\"${classe}\">Question ${i+1} ➔ Votre réponse : <strong>${userAnswers[i]}</strong><br>Bonne réponse : <strong>${m.role}</strong></div>`;
  });
  document.getElementById('vosReponses').innerHTML = texte;
}
</script>

</body>
</html>
